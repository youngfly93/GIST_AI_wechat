
è§£é‡Š
logo
/

D
Dify's Workspace
æ¢ç´¢
å·¥ä½œå®¤
/

GIST
çŸ¥è¯†åº“
å·¥å…·
æ’ä»¶

D

ğŸ¤–
GIST
èŠå¤©åŠ©æ‰‹
ç¼–æ’
è®¿é—® API
æ—¥å¿—ä¸æ ‡æ³¨
ç›‘æµ‹
API æœåŠ¡å™¨
https://api.dify.ai/v1

è¿è¡Œä¸­

API å¯†é’¥
ç›®å½•
âœ•
å‘é€å¯¹è¯æ¶ˆæ¯
ä¸Šä¼ æ–‡ä»¶
åœæ­¢å“åº”
æ¶ˆæ¯åé¦ˆï¼ˆç‚¹èµï¼‰
è·å–ä¸‹ä¸€è½®å»ºè®®é—®é¢˜åˆ—è¡¨
è·å–ä¼šè¯å†å²æ¶ˆæ¯
è·å–ä¼šè¯åˆ—è¡¨
åˆ é™¤ä¼šè¯
ä¼šè¯é‡å‘½å
è·å–å¯¹è¯å˜é‡
è¯­éŸ³è½¬æ–‡å­—
æ–‡å­—è½¬è¯­éŸ³
è·å–åº”ç”¨åŸºæœ¬ä¿¡æ¯
è·å–åº”ç”¨å‚æ•°
è·å–åº”ç”¨Metaä¿¡æ¯
å¯¹è¯å‹åº”ç”¨ API
å¯¹è¯åº”ç”¨æ”¯æŒä¼šè¯æŒä¹…åŒ–ï¼Œå¯å°†ä¹‹å‰çš„èŠå¤©è®°å½•ä½œä¸ºä¸Šä¸‹æ–‡è¿›è¡Œå›ç­”ï¼Œå¯é€‚ç”¨äºèŠå¤©/å®¢æœ AI ç­‰ã€‚

åŸºç¡€ URL
Code
https://api.dify.ai/v1

Copy
Copied!
é‰´æƒ
Service API ä½¿ç”¨ API-Key è¿›è¡Œé‰´æƒã€‚ å¼ºçƒˆå»ºè®®å¼€å‘è€…æŠŠ API-Key æ”¾åœ¨åç«¯å­˜å‚¨ï¼Œè€Œéåˆ†äº«æˆ–è€…æ”¾åœ¨å®¢æˆ·ç«¯å­˜å‚¨ï¼Œä»¥å… API-Key æ³„éœ²ï¼Œå¯¼è‡´è´¢äº§æŸå¤±ã€‚ æ‰€æœ‰ API è¯·æ±‚éƒ½åº”åœ¨ Authorization HTTP Header ä¸­åŒ…å«æ‚¨çš„ API-Keyï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

Code
  Authorization: Bearer {API_KEY}

Copy
Copied!
POST
/chat-messages
å‘é€å¯¹è¯æ¶ˆæ¯
åˆ›å»ºä¼šè¯æ¶ˆæ¯ã€‚

Request Body
Name
query
Type
string
Description
ç”¨æˆ·è¾“å…¥/æé—®å†…å®¹ã€‚

Name
inputs
Type
object
Description
å…è®¸ä¼ å…¥ App å®šä¹‰çš„å„å˜é‡å€¼ã€‚ inputs å‚æ•°åŒ…å«äº†å¤šç»„é”®å€¼å¯¹ï¼ˆKey/Value pairsï¼‰ï¼Œæ¯ç»„çš„é”®å¯¹åº”ä¸€ä¸ªç‰¹å®šå˜é‡ï¼Œæ¯ç»„çš„å€¼åˆ™æ˜¯è¯¥å˜é‡çš„å…·ä½“å€¼ã€‚ é»˜è®¤ {}

Name
response_mode
Type
string
Description
streaming æµå¼æ¨¡å¼ï¼ˆæ¨èï¼‰ã€‚åŸºäº SSEï¼ˆServer-Sent Eventsï¼‰å®ç°ç±»ä¼¼æ‰“å­—æœºè¾“å‡ºæ–¹å¼çš„æµå¼è¿”å›ã€‚
blocking é˜»å¡æ¨¡å¼ï¼Œç­‰å¾…æ‰§è¡Œå®Œæ¯•åè¿”å›ç»“æœã€‚ï¼ˆè¯·æ±‚è‹¥æµç¨‹è¾ƒé•¿å¯èƒ½ä¼šè¢«ä¸­æ–­ï¼‰ã€‚ ç”±äº Cloudflare é™åˆ¶ï¼Œè¯·æ±‚ä¼šåœ¨ 100 ç§’è¶…æ—¶æ— è¿”å›åä¸­æ–­ã€‚ æ³¨ï¼šAgentæ¨¡å¼ä¸‹ä¸å…è®¸blockingã€‚
Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”¨äºå®šä¹‰ç»ˆç«¯ç”¨æˆ·çš„èº«ä»½ï¼Œæ–¹ä¾¿æ£€ç´¢ã€ç»Ÿè®¡ã€‚ ç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Name
conversation_id
Type
string
Description
ï¼ˆé€‰å¡«ï¼‰ä¼šè¯ IDï¼Œéœ€è¦åŸºäºä¹‹å‰çš„èŠå¤©è®°å½•ç»§ç»­å¯¹è¯ï¼Œå¿…é¡»ä¼ ä¹‹å‰æ¶ˆæ¯çš„ conversation_idã€‚

Name
files
Type
array[object]
Description
ä¸Šä¼ çš„æ–‡ä»¶ã€‚

type (string) æ”¯æŒç±»å‹ï¼šå›¾ç‰‡ imageï¼ˆç›®å‰ä»…æ”¯æŒå›¾ç‰‡æ ¼å¼ï¼‰ ã€‚
transfer_method (string) ä¼ é€’æ–¹å¼:
remote_url: å›¾ç‰‡åœ°å€ã€‚
local_file: ä¸Šä¼ æ–‡ä»¶ã€‚
url å›¾ç‰‡åœ°å€ã€‚ï¼ˆä»…å½“ä¼ é€’æ–¹å¼ä¸º remote_url æ—¶ï¼‰ã€‚
upload_file_id ä¸Šä¼ æ–‡ä»¶ IDã€‚ï¼ˆä»…å½“ä¼ é€’æ–¹å¼ä¸º local_file æ—¶ï¼‰ã€‚
Name
auto_generate_name
Type
bool
Description
ï¼ˆé€‰å¡«ï¼‰è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ï¼Œé»˜è®¤ trueã€‚ è‹¥è®¾ç½®ä¸º falseï¼Œåˆ™å¯é€šè¿‡è°ƒç”¨ä¼šè¯é‡å‘½åæ¥å£å¹¶è®¾ç½® auto_generate ä¸º true å®ç°å¼‚æ­¥ç”Ÿæˆæ ‡é¢˜ã€‚

Response
å½“ response_mode ä¸º blocking æ—¶ï¼Œè¿”å› ChatCompletionResponse objectã€‚ å½“ response_mode ä¸º streamingæ—¶ï¼Œè¿”å› ChunkChatCompletionResponse object æµå¼åºåˆ—ã€‚

ChatCompletionResponse
è¿”å›å®Œæ•´çš„ App ç»“æœï¼ŒContent-Type ä¸º application/jsonã€‚

event (string) äº‹ä»¶ç±»å‹ï¼Œå›ºå®šä¸º message
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
id (string) å”¯ä¸€ID
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
conversation_id (string) ä¼šè¯ ID
mode (string) App æ¨¡å¼ï¼Œå›ºå®šä¸º chat
answer (string) å®Œæ•´å›å¤å†…å®¹
metadata (object) å…ƒæ•°æ®
usage (Usage) æ¨¡å‹ç”¨é‡ä¿¡æ¯
retriever_resources (array[RetrieverResource]) å¼•ç”¨å’Œå½’å±åˆ†æ®µåˆ—è¡¨
created_at (int) æ¶ˆæ¯åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
ChunkChatCompletionResponse
è¿”å› App è¾“å‡ºçš„æµå¼å—ï¼ŒContent-Type ä¸º text/event-streamã€‚ æ¯ä¸ªæµå¼å—å‡ä¸º data: å¼€å¤´ï¼Œå—ä¹‹é—´ä»¥ \n\n å³ä¸¤ä¸ªæ¢è¡Œç¬¦åˆ†éš”ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

data: {"event": "message", "task_id": "900bbd43-dc0b-4383-a372-aa6e6c414227", "id": "663c5084-a254-4040-8ad3-51f2a3c1a77c", "answer": "Hi", "created_at": 1705398420}\n\n

Copy
Copied!
æµå¼å—ä¸­æ ¹æ® event ä¸åŒï¼Œç»“æ„ä¹Ÿä¸åŒï¼š

event: message LLM è¿”å›æ–‡æœ¬å—äº‹ä»¶ï¼Œå³ï¼šå®Œæ•´çš„æ–‡æœ¬ä»¥åˆ†å—çš„æ–¹å¼è¾“å‡ºã€‚
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
conversation_id (string) ä¼šè¯ ID
answer (string) LLM è¿”å›æ–‡æœ¬å—å†…å®¹
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
event: agent_message Agentæ¨¡å¼ä¸‹è¿”å›æ–‡æœ¬å—äº‹ä»¶ï¼Œå³ï¼šåœ¨Agentæ¨¡å¼ä¸‹ï¼Œæ–‡ç« çš„æ–‡æœ¬ä»¥åˆ†å—çš„æ–¹å¼è¾“å‡ºï¼ˆä»…Agentæ¨¡å¼ä¸‹ä½¿ç”¨ï¼‰
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
conversation_id (string) ä¼šè¯ ID
answer (string) LLM è¿”å›æ–‡æœ¬å—å†…å®¹
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
event: agent_thought Agentæ¨¡å¼ä¸‹æœ‰å…³Agentæ€è€ƒæ­¥éª¤çš„ç›¸å…³å†…å®¹ï¼Œæ¶‰åŠåˆ°å·¥å…·è°ƒç”¨ï¼ˆä»…Agentæ¨¡å¼ä¸‹ä½¿ç”¨ï¼‰
id (string) agent_thought IDï¼Œæ¯ä¸€è½®Agentè¿­ä»£éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„id
task_id (string) ä»»åŠ¡IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ID
position (int) agent_thoughtåœ¨æ¶ˆæ¯ä¸­çš„ä½ç½®ï¼Œå¦‚ç¬¬ä¸€è½®è¿­ä»£positionä¸º1
thought (string) agentçš„æ€è€ƒå†…å®¹
observation (string) å·¥å…·è°ƒç”¨çš„è¿”å›ç»“æœ
tool (string) ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼Œä»¥ ; åˆ†å‰²å¤šä¸ªå·¥å…·
tool_input (string) å·¥å…·çš„è¾“å…¥ï¼ŒJSONæ ¼å¼çš„å­—ç¬¦ä¸²(object)ã€‚å¦‚ï¼š{"dalle3": {"prompt": "a cute cat"}}
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
message_files (array[string]) å½“å‰ agent_thought å…³è”çš„æ–‡ä»¶ID
file_id (string) æ–‡ä»¶ID
conversation_id (string) ä¼šè¯ID
event: message_file æ–‡ä»¶äº‹ä»¶ï¼Œè¡¨ç¤ºæœ‰æ–°æ–‡ä»¶éœ€è¦å±•ç¤º
id (string) æ–‡ä»¶å”¯ä¸€ID
type (string) æ–‡ä»¶ç±»å‹ï¼Œç›®å‰ä»…ä¸ºimage
belongs_to (string) æ–‡ä»¶å½’å±ï¼Œuseræˆ–assistantï¼Œè¯¥æ¥å£è¿”å›ä»…ä¸º assistant
url (string) æ–‡ä»¶è®¿é—®åœ°å€
conversation_id (string) ä¼šè¯ID
event: message_end æ¶ˆæ¯ç»“æŸäº‹ä»¶ï¼Œæ”¶åˆ°æ­¤äº‹ä»¶åˆ™ä»£è¡¨æµå¼è¿”å›ç»“æŸã€‚
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
conversation_id (string) ä¼šè¯ ID
metadata (object) å…ƒæ•°æ®
usage (Usage) æ¨¡å‹ç”¨é‡ä¿¡æ¯
retriever_resources (array[RetrieverResource]) å¼•ç”¨å’Œå½’å±åˆ†æ®µåˆ—è¡¨
event: tts_message TTS éŸ³é¢‘æµäº‹ä»¶ï¼Œå³ï¼šè¯­éŸ³åˆæˆè¾“å‡ºã€‚å†…å®¹æ˜¯Mp3æ ¼å¼çš„éŸ³é¢‘å—ï¼Œä½¿ç”¨ base64 ç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œæ’­æ”¾çš„æ—¶å€™ç›´æ¥è§£ç å³å¯ã€‚(å¼€å¯è‡ªåŠ¨æ’­æ”¾æ‰æœ‰æ­¤æ¶ˆæ¯)
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
audio (string) è¯­éŸ³åˆæˆä¹‹åçš„éŸ³é¢‘å—ä½¿ç”¨ Base64 ç¼–ç ä¹‹åçš„æ–‡æœ¬å†…å®¹ï¼Œæ’­æ”¾çš„æ—¶å€™ç›´æ¥ base64 è§£ç é€å…¥æ’­æ”¾å™¨å³å¯
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
event: tts_message_end TTS éŸ³é¢‘æµç»“æŸäº‹ä»¶ï¼Œæ”¶åˆ°è¿™ä¸ªäº‹ä»¶è¡¨ç¤ºéŸ³é¢‘æµè¿”å›ç»“æŸã€‚
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
audio (string) ç»“æŸäº‹ä»¶æ˜¯æ²¡æœ‰éŸ³é¢‘çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ç©ºå­—ç¬¦ä¸²
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
event: message_replace æ¶ˆæ¯å†…å®¹æ›¿æ¢äº‹ä»¶ã€‚ å¼€å¯å†…å®¹å®¡æŸ¥å’Œå®¡æŸ¥è¾“å‡ºå†…å®¹æ—¶ï¼Œè‹¥å‘½ä¸­äº†å®¡æŸ¥æ¡ä»¶ï¼Œåˆ™ä¼šé€šè¿‡æ­¤äº‹ä»¶æ›¿æ¢æ¶ˆæ¯å†…å®¹ä¸ºé¢„è®¾å›å¤ã€‚
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
conversation_id (string) ä¼šè¯ ID
answer (string) æ›¿æ¢å†…å®¹ï¼ˆç›´æ¥æ›¿æ¢ LLM æ‰€æœ‰å›å¤æ–‡æœ¬ï¼‰
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
event: error æµå¼è¾“å‡ºè¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ä¼šä»¥ stream event å½¢å¼è¾“å‡ºï¼Œæ”¶åˆ°å¼‚å¸¸äº‹ä»¶åå³ç»“æŸã€‚
task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
status (int) HTTP çŠ¶æ€ç 
code (string) é”™è¯¯ç 
message (string) é”™è¯¯æ¶ˆæ¯
event: ping æ¯ 10s ä¸€æ¬¡çš„ ping äº‹ä»¶ï¼Œä¿æŒè¿æ¥å­˜æ´»ã€‚
Errors
404ï¼Œå¯¹è¯ä¸å­˜åœ¨
400ï¼Œinvalid_paramï¼Œä¼ å…¥å‚æ•°å¼‚å¸¸
400ï¼Œapp_unavailableï¼ŒApp é…ç½®ä¸å¯ç”¨
400ï¼Œprovider_not_initializeï¼Œæ— å¯ç”¨æ¨¡å‹å‡­æ®é…ç½®
400ï¼Œprovider_quota_exceededï¼Œæ¨¡å‹è°ƒç”¨é¢åº¦ä¸è¶³
400ï¼Œmodel_currently_not_supportï¼Œå½“å‰æ¨¡å‹ä¸å¯ç”¨
400ï¼Œcompletion_request_errorï¼Œæ–‡æœ¬ç”Ÿæˆå¤±è´¥
500ï¼ŒæœåŠ¡å†…éƒ¨å¼‚å¸¸
Request
POST
/chat-messages
curl -X POST 'https://api.dify.ai/v1/chat-messages' \
--header 'Authorization: Bearer {api_key}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "inputs": {},
    "query": "What are the specs of the iPhone 13 Pro Max?",
    "response_mode": "streaming",
    "conversation_id": "",
    "user": "abc-123",
    "files": [
      {
        "type": "image",
        "transfer_method": "remote_url",
        "url": "https://cloud.dify.ai/logo/logo-site.png"
      }
    ]
}'

Copy
Copied!
é˜»å¡æ¨¡å¼
Response
{
    "event": "message",
    "task_id": "c3800678-a077-43df-a102-53f23ed20b88", 
    "id": "9da23599-e713-473b-982c-4328d4f5c78a",
    "message_id": "9da23599-e713-473b-982c-4328d4f5c78a",
    "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2",
    "mode": "chat",
    "answer": "iPhone 13 Pro Max specs are listed here:...",
    "metadata": {
        "usage": {
            "prompt_tokens": 1033,
            "prompt_unit_price": "0.001",
            "prompt_price_unit": "0.001",
            "prompt_price": "0.0010330",
            "completion_tokens": 128,
            "completion_unit_price": "0.002",
            "completion_price_unit": "0.001",
            "completion_price": "0.0002560",
            "total_tokens": 1161,
            "total_price": "0.0012890",
            "currency": "USD",
            "latency": 0.7682376249867957
        },
        "retriever_resources": [
            {
                "position": 1,
                "dataset_id": "101b4c97-fc2e-463c-90b1-5261a4cdcafb",
                "dataset_name": "iPhone",
                "document_id": "8dd1ad74-0b5f-4175-b735-7d98bbbb4e00",
                "document_name": "iPhone List",
                "segment_id": "ed599c7f-2766-4294-9d1d-e5235a61270a",
                "score": 0.98457545,
                "content": "\"Model\",\"Release Date\",\"Display Size\",\"Resolution\",\"Processor\",\"RAM\",\"Storage\",\"Camera\",\"Battery\",\"Operating System\"\n\"iPhone 13 Pro Max\",\"September 24, 2021\",\"6.7 inch\",\"1284 x 2778\",\"Hexa-core (2x3.23 GHz Avalanche + 4x1.82 GHz Blizzard)\",\"6 GB\",\"128, 256, 512 GB, 1TB\",\"12 MP\",\"4352 mAh\",\"iOS 15\""
            }
        ]
    },
    "created_at": 1705407629
}

Copy
Copied!
æµå¼æ¨¡å¼ï¼ˆåŸºç¡€åŠ©æ‰‹ï¼‰
Response
  data: {"event": "message", "message_id": "5ad4cb98-f0c7-4085-b384-88c403be6290", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "answer": " I", "created_at": 1679586595}
  data: {"event": "message", "message_id": "5ad4cb98-f0c7-4085-b384-88c403be6290", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "answer": "'m", "created_at": 1679586595}
  data: {"event": "message", "message_id": "5ad4cb98-f0c7-4085-b384-88c403be6290", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "answer": " glad", "created_at": 1679586595}
  data: {"event": "message", "message_id": "5ad4cb98-f0c7-4085-b384-88c403be6290", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "answer": " to", "created_at": 1679586595}
  data: {"event": "message", "message_id" : "5ad4cb98-f0c7-4085-b384-88c403be6290", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "answer": " meet", "created_at": 1679586595}
  data: {"event": "message", "message_id" : "5ad4cb98-f0c7-4085-b384-88c403be6290", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "answer": " you", "created_at": 1679586595}
  data: {"event": "message_end", "id": "5e52ce04-874b-4d27-9045-b3bc80def685", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "metadata": {"usage": {"prompt_tokens": 1033, "prompt_unit_price": "0.001", "prompt_price_unit": "0.001", "prompt_price": "0.0010330", "completion_tokens": 135, "completion_unit_price": "0.002", "completion_price_unit": "0.001", "completion_price": "0.0002700", "total_tokens": 1168, "total_price": "0.0013030", "currency": "USD", "latency": 1.381760165997548}, "retriever_resources": [{"position": 1, "dataset_id": "101b4c97-fc2e-463c-90b1-5261a4cdcafb", "dataset_name": "iPhone", "document_id": "8dd1ad74-0b5f-4175-b735-7d98bbbb4e00", "document_name": "iPhone List", "segment_id": "ed599c7f-2766-4294-9d1d-e5235a61270a", "score": 0.98457545, "content": "\"Model\",\"Release Date\",\"Display Size\",\"Resolution\",\"Processor\",\"RAM\",\"Storage\",\"Camera\",\"Battery\",\"Operating System\"\n\"iPhone 13 Pro Max\",\"September 24, 2021\",\"6.7 inch\",\"1284 x 2778\",\"Hexa-core (2x3.23 GHz Avalanche + 4x1.82 GHz Blizzard)\",\"6 GB\",\"128, 256, 512 GB, 1TB\",\"12 MP\",\"4352 mAh\",\"iOS 15\""}]}}
  data: {"event": "tts_message", "conversation_id": "23dd85f3-1a41-4ea0-b7a9-062734ccfaf9", "message_id": "a8bdc41c-13b2-4c18-bfd9-054b9803038c", "created_at": 1721205487, "task_id": "3bf8a0bb-e73b-4690-9e66-4e429bad8ee7", "audio": "qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"}
  data: {"event": "tts_message_end", "conversation_id": "23dd85f3-1a41-4ea0-b7a9-062734ccfaf9", "message_id": "a8bdc41c-13b2-4c18-bfd9-054b9803038c", "created_at": 1721205487, "task_id": "3bf8a0bb-e73b-4690-9e66-4e429bad8ee7", "audio": ""}

Copy
Copied!
æµå¼æ¨¡å¼ï¼ˆæ™ºèƒ½åŠ©æ‰‹ï¼‰
Response
  data: {"event": "agent_thought", "id": "8dcf3648-fbad-407a-85dd-73a6f43aeb9f", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "position": 1, "thought": "", "observation": "", "tool": "", "tool_input": "", "created_at": 1705639511, "message_files": [], "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_thought", "id": "8dcf3648-fbad-407a-85dd-73a6f43aeb9f", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "position": 1, "thought": "", "observation": "", "tool": "dalle3", "tool_input": "{\"dalle3\": {\"prompt\": \"cute Japanese anime girl with white hair, blue eyes, bunny girl suit\"}}", "created_at": 1705639511, "message_files": [], "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "message_file", "id": "d75b7a5c-ce5e-442e-ab1b-d6a5e5b557b0", "type": "image", "belongs_to": "assistant", "url": "http://127.0.0.1:5001/files/tools/d75b7a5c-ce5e-442e-ab1b-d6a5e5b557b0.png?timestamp=1705639526&nonce=70423256c60da73a9c96d1385ff78487&sign=7B5fKV9890YJuqchQvrABvW4AIupDvDvxGdu1EOJT94=", "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_thought", "id": "8dcf3648-fbad-407a-85dd-73a6f43aeb9f", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "position": 1, "thought": "", "observation": "image has been created and sent to user already, you should tell user to check it now.", "tool": "dalle3", "tool_input": "{\"dalle3\": {\"prompt\": \"cute Japanese anime girl with white hair, blue eyes, bunny girl suit\"}}", "created_at": 1705639511, "message_files": ["d75b7a5c-ce5e-442e-ab1b-d6a5e5b557b0"], "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_thought", "id": "67a99dc1-4f82-42d3-b354-18d4594840c8", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "position": 2, "thought": "", "observation": "", "tool": "", "tool_input": "", "created_at": 1705639511, "message_files": [], "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_message", "id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "answer": "I have created an image of a cute Japanese", "created_at": 1705639511, "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_message", "id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "answer": " anime girl with white hair and blue", "created_at": 1705639511, "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_message", "id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "answer": " eyes wearing a bunny girl" ,"created_at": 1705639511, "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_message", "id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "answer": " suit .", "created_at": 1705639511, "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "agent_thought", "id": "67a99dc1-4f82-42d3-b354-18d4594840c8", "task_id": "9cf1ddd7-f94b-459b-b942-b77b26c59e9b", "message_id": "1fb10045-55fd-4040-99e6-d048d07cbad3", "position": 2, "thought": "I have created an image of a cute Japanese anime girl with white hair and blue eyes wearing a bunny girl suit.", "observation": "", "tool": "", "tool_input": "", "created_at": 1705639511, "message_files": [], "conversation_id": "c216c595-2d89-438c-b33c-aae5ddddd142"}
  data: {"event": "message_end", "id": "5e52ce04-874b-4d27-9045-b3bc80def685", "conversation_id": "45701982-8118-4bc5-8e9b-64562b4555f2", "metadata": {"usage": {"prompt_tokens": 1033, "prompt_unit_price": "0.001", "prompt_price_unit": "0.001", "prompt_price": "0.0010330", "completion_tokens": 135, "completion_unit_price": "0.002", "completion_price_unit": "0.001", "completion_price": "0.0002700", "total_tokens": 1168, "total_price": "0.0013030", "currency": "USD", "latency": 1.381760165997548}, "retriever_resources": [{"position": 1, "dataset_id": "101b4c97-fc2e-463c-90b1-5261a4cdcafb", "dataset_name": "iPhone", "document_id": "8dd1ad74-0b5f-4175-b735-7d98bbbb4e00", "document_name": "iPhone List", "segment_id": "ed599c7f-2766-4294-9d1d-e5235a61270a", "score": 0.98457545, "content": "\"Model\",\"Release Date\",\"Display Size\",\"Resolution\",\"Processor\",\"RAM\",\"Storage\",\"Camera\",\"Battery\",\"Operating System\"\n\"iPhone 13 Pro Max\",\"September 24, 2021\",\"6.7 inch\",\"1284 x 2778\",\"Hexa-core (2x3.23 GHz Avalanche + 4x1.82 GHz Blizzard)\",\"6 GB\",\"128, 256, 512 GB, 1TB\",\"12 MP\",\"4352 mAh\",\"iOS 15\""}]}}
  data: {"event": "tts_message", "conversation_id": "23dd85f3-1a41-4ea0-b7a9-062734ccfaf9", "message_id": "a8bdc41c-13b2-4c18-bfd9-054b9803038c", "created_at": 1721205487, "task_id": "3bf8a0bb-e73b-4690-9e66-4e429bad8ee7", "audio": "qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"}
  data: {"event": "tts_message_end", "conversation_id": "23dd85f3-1a41-4ea0-b7a9-062734ccfaf9", "message_id": "a8bdc41c-13b2-4c18-bfd9-054b9803038c", "created_at": 1721205487, "task_id": "3bf8a0bb-e73b-4690-9e66-4e429bad8ee7", "audio": ""}

Copy
Copied!
POST
/files/upload
ä¸Šä¼ æ–‡ä»¶
ä¸Šä¼ æ–‡ä»¶ï¼ˆç›®å‰ä»…æ”¯æŒå›¾ç‰‡ï¼‰å¹¶åœ¨å‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨ï¼Œå¯å®ç°å›¾æ–‡å¤šæ¨¡æ€ç†è§£ã€‚ æ”¯æŒ png, jpg, jpeg, webp, gif æ ¼å¼ã€‚ ä¸Šä¼ çš„æ–‡ä»¶ä»…ä¾›å½“å‰ç»ˆç«¯ç”¨æˆ·ä½¿ç”¨ã€‚

Request Body
è¯¥æ¥å£éœ€ä½¿ç”¨ multipart/form-data è¿›è¡Œè¯·æ±‚ã€‚

Name
file
Type
file
Description
è¦ä¸Šä¼ çš„æ–‡ä»¶ã€‚

Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”¨äºå®šä¹‰ç»ˆç«¯ç”¨æˆ·çš„èº«ä»½ï¼Œå¿…é¡»å’Œå‘é€æ¶ˆæ¯æ¥å£ä¼ å…¥ user ä¿æŒä¸€è‡´ã€‚

Response
æˆåŠŸä¸Šä¼ åï¼ŒæœåŠ¡å™¨ä¼šè¿”å›æ–‡ä»¶çš„ ID å’Œç›¸å…³ä¿¡æ¯ã€‚

id (uuid) ID
name (string) æ–‡ä»¶å
size (int) æ–‡ä»¶å¤§å°ï¼ˆbyteï¼‰
extension (string) æ–‡ä»¶åç¼€
mime_type (string) æ–‡ä»¶ mime-type
created_by (uuid) ä¸Šä¼ äºº ID
created_at (timestamp) ä¸Šä¼ æ—¶é—´
Errors
400ï¼Œno_file_uploadedï¼Œå¿…é¡»æä¾›æ–‡ä»¶
400ï¼Œtoo_many_filesï¼Œç›®å‰åªæ¥å—ä¸€ä¸ªæ–‡ä»¶
400ï¼Œunsupported_previewï¼Œè¯¥æ–‡ä»¶ä¸æ”¯æŒé¢„è§ˆ
400ï¼Œunsupported_estimateï¼Œè¯¥æ–‡ä»¶ä¸æ”¯æŒä¼°ç®—
413ï¼Œfile_too_largeï¼Œæ–‡ä»¶å¤ªå¤§
415ï¼Œunsupported_file_typeï¼Œä¸æ”¯æŒçš„æ‰©å±•åï¼Œå½“å‰åªæ¥å—æ–‡æ¡£ç±»æ–‡ä»¶
503ï¼Œs3_connection_failedï¼Œæ— æ³•è¿æ¥åˆ° S3 æœåŠ¡
503ï¼Œs3_permission_deniedï¼Œæ— æƒé™ä¸Šä¼ æ–‡ä»¶åˆ° S3
503ï¼Œs3_file_too_largeï¼Œæ–‡ä»¶è¶…å‡º S3 å¤§å°é™åˆ¶
Request
POST
/files/upload
curl -X POST 'https://api.dify.ai/v1/files/upload' \
--header 'Authorization: Bearer {api_key}' \
--form 'file=@localfile;type=image/[png|jpeg|jpg|webp|gif] \
--form 'user=abc-123'

Copy
Copied!
Response
{
  "id": "72fa9618-8f89-4a37-9b33-7e1178a24a67",
  "name": "example.png",
  "size": 1024,
  "extension": "png",
  "mime_type": "image/png",
  "created_by": 123,
  "created_at": 1577836800,
}

Copy
Copied!
POST
/chat-messages/:task_id/stop
åœæ­¢å“åº”
ä»…æ”¯æŒæµå¼æ¨¡å¼ã€‚

Path
task_id (string) ä»»åŠ¡ IDï¼Œå¯åœ¨æµå¼è¿”å› Chunk ä¸­è·å–
Request Body
user (string) Required ç”¨æˆ·æ ‡è¯†ï¼Œç”¨äºå®šä¹‰ç»ˆç«¯ç”¨æˆ·çš„èº«ä»½ï¼Œå¿…é¡»å’Œå‘é€æ¶ˆæ¯æ¥å£ä¼ å…¥ user ä¿æŒä¸€è‡´ã€‚
Response
result (string) å›ºå®šè¿”å› success
Request
POST
/chat-messages/:task_id/stop
curl -X POST 'https://api.dify.ai/v1/chat-messages/:task_id/stop' \
-H 'Authorization: Bearer {api_key}' \
-H 'Content-Type: application/json' \
--data-raw '{ "user": "abc-123"}'

Copy
Copied!
Response
{
  "result": "success"
}

Copy
Copied!
POST
/messages/:message_id/feedbacks
æ¶ˆæ¯åé¦ˆï¼ˆç‚¹èµï¼‰
æ¶ˆæ¯ç»ˆç«¯ç”¨æˆ·åé¦ˆã€ç‚¹èµï¼Œæ–¹ä¾¿åº”ç”¨å¼€å‘è€…ä¼˜åŒ–è¾“å‡ºé¢„æœŸã€‚

Path Params
Name
message_id
Type
string
Description
æ¶ˆæ¯ ID

Request Body
Name
rating
Type
string
Description
ç‚¹èµ like, ç‚¹è¸© dislike, æ’¤é”€ç‚¹èµ null

Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Name
content
Type
string
Description
æ¶ˆæ¯åé¦ˆçš„å…·ä½“ä¿¡æ¯ã€‚

Response
result (string) å›ºå®šè¿”å› success
Request
POST
/messages/:message_id/feedbacks
curl -X POST 'https://api.dify.ai/v1/messages/:message_id/feedbacks \
--header 'Authorization: Bearer {api_key}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "rating": "like",
    "user": "abc-123",
    "content": "message feedback information"
}'

Copy
Copied!
Response
{
  "result": "success"
}

Copy
Copied!
GET
/messages/{message_id}/suggested
è·å–ä¸‹ä¸€è½®å»ºè®®é—®é¢˜åˆ—è¡¨
è·å–ä¸‹ä¸€è½®å»ºè®®é—®é¢˜åˆ—è¡¨ã€‚

Path Params
Name
message_id
Type
string
Description
Message ID

Query
Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Request
GET
/messages/{message_id}/suggested
curl --location --request GET 'https://api.dify.ai/v1/messages/{message_id}/suggested?user=abc-123 \
--header 'Authorization: Bearer ENTER-YOUR-SECRET-KEY' \
--header 'Content-Type: application/json'

Copy
Copied!
Response
{
  "result": "success",
  "data": [
        "a",
        "b",
        "c"
    ]
}

Copy
Copied!
GET
/messages
è·å–ä¼šè¯å†å²æ¶ˆæ¯
æ»šåŠ¨åŠ è½½å½¢å¼è¿”å›å†å²èŠå¤©è®°å½•ï¼Œç¬¬ä¸€é¡µè¿”å›æœ€æ–° limit æ¡ï¼Œå³ï¼šå€’åºè¿”å›ã€‚

Query
Name
conversation_id
Type
string
Description
ä¼šè¯ ID

Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Name
first_id
Type
string
Description
å½“å‰é¡µç¬¬ä¸€æ¡èŠå¤©è®°å½•çš„ IDï¼Œé»˜è®¤ null

Name
limit
Type
int
Description
ä¸€æ¬¡è¯·æ±‚è¿”å›å¤šå°‘æ¡èŠå¤©è®°å½•ï¼Œé»˜è®¤ 20 æ¡ã€‚

Response
data (array[object]) æ¶ˆæ¯åˆ—è¡¨
id (string) æ¶ˆæ¯ ID
conversation_id (string) ä¼šè¯ ID
inputs (object) ç”¨æˆ·è¾“å…¥å‚æ•°ã€‚
query (string) ç”¨æˆ·è¾“å…¥ / æé—®å†…å®¹ã€‚
message_files (array[object]) æ¶ˆæ¯æ–‡ä»¶
id (string) ID
type (string) æ–‡ä»¶ç±»å‹ï¼Œimage å›¾ç‰‡
url (string) é¢„è§ˆå›¾ç‰‡åœ°å€
belongs_to (string) æ–‡ä»¶å½’å±æ–¹ï¼Œuser æˆ– assistant
agent_thoughts (array[object]) Agentæ€è€ƒå†…å®¹ï¼ˆä»…Agentæ¨¡å¼ä¸‹ä¸ä¸ºç©ºï¼‰
id (string) agent_thought IDï¼Œæ¯ä¸€è½®Agentè¿­ä»£éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„id
message_id (string) æ¶ˆæ¯å”¯ä¸€ID
position (int) agent_thoughtåœ¨æ¶ˆæ¯ä¸­çš„ä½ç½®ï¼Œå¦‚ç¬¬ä¸€è½®è¿­ä»£positionä¸º1
thought (string) agentçš„æ€è€ƒå†…å®¹
observation (string) å·¥å…·è°ƒç”¨çš„è¿”å›ç»“æœ
tool (string) ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼Œä»¥ ; åˆ†å‰²å¤šä¸ªå·¥å…·
tool_input (string) å·¥å…·çš„è¾“å…¥ï¼ŒJSONæ ¼å¼çš„å­—ç¬¦ä¸²(object)ã€‚å¦‚ï¼š{"dalle3": {"prompt": "a cute cat"}}
created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
message_files (array[string]) å½“å‰agent_thought å…³è”çš„æ–‡ä»¶ID
file_id (string) æ–‡ä»¶ID
conversation_id (string) ä¼šè¯ID
answer (string) å›ç­”æ¶ˆæ¯å†…å®¹
created_at (timestamp) åˆ›å»ºæ—¶é—´
feedback (object) åé¦ˆä¿¡æ¯
rating (string) ç‚¹èµ like / ç‚¹è¸© dislike
retriever_resources (array[RetrieverResource]) å¼•ç”¨å’Œå½’å±åˆ†æ®µåˆ—è¡¨
has_more (bool) æ˜¯å¦å­˜åœ¨ä¸‹ä¸€é¡µ
limit (int) è¿”å›æ¡æ•°ï¼Œè‹¥ä¼ å…¥è¶…è¿‡ç³»ç»Ÿé™åˆ¶ï¼Œè¿”å›ç³»ç»Ÿé™åˆ¶æ•°é‡
Request Example
Request
GET
/messages
curl -X GET 'https://api.dify.ai/v1/messages?user=abc-123&conversation_id=' \
--header 'Authorization: Bearer {api_key}'

Copy
Copied!
Response Example(åŸºç¡€åŠ©æ‰‹)
Response
{
"limit": 20,
"has_more": false,
"data": [
    {
        "id": "a076a87f-31e5-48dc-b452-0061adbbc922",
        "conversation_id": "cd78daf6-f9e4-4463-9ff2-54257230a0ce",
        "inputs": {
            "name": "dify"
        },
        "query": "iphone 13 pro",
        "answer": "The iPhone 13 Pro, released on September 24, 2021, features a 6.1-inch display with a resolution of 1170 x 2532. It is equipped with a Hexa-core (2x3.23 GHz Avalanche + 4x1.82 GHz Blizzard) processor, 6 GB of RAM, and offers storage options of 128 GB, 256 GB, 512 GB, and 1 TB. The camera is 12 MP, the battery capacity is 3095 mAh, and it runs on iOS 15.",
        "message_files": [],
        "feedback": null,
        "retriever_resources": [
            {
                "position": 1,
                "dataset_id": "101b4c97-fc2e-463c-90b1-5261a4cdcafb",
                "dataset_name": "iPhone",
                "document_id": "8dd1ad74-0b5f-4175-b735-7d98bbbb4e00",
                "document_name": "iPhone List",
                "segment_id": "ed599c7f-2766-4294-9d1d-e5235a61270a",
                "score": 0.98457545,
                "content": "\"Model\",\"Release Date\",\"Display Size\",\"Resolution\",\"Processor\",\"RAM\",\"Storage\",\"Camera\",\"Battery\",\"Operating System\"\n\"iPhone 13 Pro Max\",\"September 24, 2021\",\"6.7 inch\",\"1284 x 2778\",\"Hexa-core (2x3.23 GHz Avalanche + 4x1.82 GHz Blizzard)\",\"6 GB\",\"128, 256, 512 GB, 1TB\",\"12 MP\",\"4352 mAh\",\"iOS 15\""
            }
        ],
        "agent_thoughts": [],
        "created_at": 1705569239
    }
  ]
}

Copy
Copied!
Response Example(æ™ºèƒ½åŠ©æ‰‹)
Response
{
"limit": 20,
"has_more": false,
"data": [
    {
        "id": "d35e006c-7c4d-458f-9142-be4930abdf94",
        "conversation_id": "957c068b-f258-4f89-ba10-6e8a0361c457",
        "inputs": {},
        "query": "draw a cat",
        "answer": "I have generated an image of a cat for you. Please check your messages to view the image.",
        "message_files": [
            {
                "id": "976990d2-5294-47e6-8f14-7356ba9d2d76",
                "type": "image",
                "url": "http://127.0.0.1:5001/files/tools/976990d2-5294-47e6-8f14-7356ba9d2d76.png?timestamp=1705988524&nonce=55df3f9f7311a9acd91bf074cd524092&sign=z43nMSO1L2HBvoqADLkRxr7Biz0fkjeDstnJiCK1zh8=",
                "belongs_to": "assistant"
            }
        ],
        "feedback": null,
        "retriever_resources": [],
        "created_at": 1705988187,
        "agent_thoughts": [
            {
                "id": "592c84cf-07ee-441c-9dcc-ffc66c033469",
                "chain_id": null,
                "message_id": "d35e006c-7c4d-458f-9142-be4930abdf94",
                "position": 1,
                "thought": "",
                "tool": "dalle2",
                "tool_input": "{\"dalle2\": {\"prompt\": \"cat\"}}",
                "created_at": 1705988186,
                "observation": "image has been created and sent to user already, you should tell user to check it now.",
                "files": [
                    "976990d2-5294-47e6-8f14-7356ba9d2d76"
                ]
            },
            {
                "id": "73ead60d-2370-4780-b5ed-532d2762b0e5",
                "chain_id": null,
                "message_id": "d35e006c-7c4d-458f-9142-be4930abdf94",
                "position": 2,
                "thought": "I have generated an image of a cat for you. Please check your messages to view the image.",
                "tool": "",
                "tool_input": "",
                "created_at": 1705988199,
                "observation": "",
                "files": []
            }
        ]
    }
    ]
}

Copy
Copied!
GET
/conversations
è·å–ä¼šè¯åˆ—è¡¨
è·å–å½“å‰ç”¨æˆ·çš„ä¼šè¯åˆ—è¡¨ï¼Œé»˜è®¤è¿”å›æœ€è¿‘çš„ 20 æ¡ã€‚

Query
Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Name
last_id
Type
string
Description
ï¼ˆé€‰å¡«ï¼‰å½“å‰é¡µæœ€åé¢ä¸€æ¡è®°å½•çš„ IDï¼Œé»˜è®¤ null

Name
limit
Type
int
Description
ï¼ˆé€‰å¡«ï¼‰ä¸€æ¬¡è¯·æ±‚è¿”å›å¤šå°‘æ¡è®°å½•ï¼Œé»˜è®¤ 20 æ¡ï¼Œæœ€å¤§ 100 æ¡ï¼Œæœ€å° 1 æ¡ã€‚

Name
sort_by
Type
string
Description
ï¼ˆé€‰å¡«ï¼‰æ’åºå­—æ®µï¼Œé»˜è®¤ -updated_at(æŒ‰æ›´æ–°æ—¶é—´å€’åºæ’åˆ—)

å¯é€‰å€¼ï¼šcreated_at, -created_at, updated_at, -updated_at
å­—æ®µå‰é¢çš„ç¬¦å·ä»£è¡¨é¡ºåºæˆ–å€’åºï¼Œ-ä»£è¡¨å€’åº
Response
data (array[object]) ä¼šè¯åˆ—è¡¨
id (string) ä¼šè¯ ID
name (string) ä¼šè¯åç§°ï¼Œé»˜è®¤ä¸ºä¼šè¯ä¸­ç”¨æˆ·æœ€å¼€å§‹é—®é¢˜çš„æˆªå–ã€‚
inputs (object) ç”¨æˆ·è¾“å…¥å‚æ•°ã€‚
status (string) ä¼šè¯çŠ¶æ€
introduction (string) å¼€åœºç™½
created_at (timestamp) åˆ›å»ºæ—¶é—´
updated_at (timestamp) æ›´æ–°æ—¶é—´
has_more (bool)
limit (int) è¿”å›æ¡æ•°ï¼Œè‹¥ä¼ å…¥è¶…è¿‡ç³»ç»Ÿé™åˆ¶ï¼Œè¿”å›ç³»ç»Ÿé™åˆ¶æ•°é‡
Request
GET
/conversations
curl -X GET 'https://api.dify.ai/v1/conversations?user=abc-123&last_id=&limit=20'\
--header 'Authorization: Bearer {api_key}'

Copy
Copied!
Response
{
  "limit": 20,
  "has_more": false,
  "data": [
    {
      "id": "10799fb8-64f7-4296-bbf7-b42bfbe0ae54",
      "name": "New chat",
      "inputs": {
          "book": "book",
          "myName": "Lucy"
      },
      "status": "normal",
      "created_at": 1679667915,
      "updated_at": 1679667915
    },
    {
      "id": "hSIhXBhNe8X1d8Et"
      // ...
    }
  ]
}

Copy
Copied!
DELETE
/conversations/:conversation_id
åˆ é™¤ä¼šè¯
åˆ é™¤ä¼šè¯ã€‚

Path
conversation_id (string) ä¼šè¯ ID
Request Body
Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Response
result (string) å›ºå®šè¿”å› success
Request
DELETE
/conversations/:conversation_id
curl -X DELETE 'https://api.dify.ai/v1/conversations/:conversation_id' \
--header 'Authorization: Bearer {api_key}' \
--header 'Content-Type: application/json' \
--data-raw '{ 
 "user": "abc-123"
}'

Copy
Copied!
Response
{
  "result": "success"
}

Copy
Copied!
POST
/conversations/:conversation_id/name
ä¼šè¯é‡å‘½å
å¯¹ä¼šè¯è¿›è¡Œé‡å‘½åï¼Œä¼šè¯åç§°ç”¨äºæ˜¾ç¤ºåœ¨æ”¯æŒå¤šä¼šè¯çš„å®¢æˆ·ç«¯ä¸Šã€‚

Path
conversation_id (string) ä¼šè¯ ID
Request Body
Name
name
Type
string
Description
ï¼ˆé€‰å¡«ï¼‰åç§°ï¼Œè‹¥ auto_generate ä¸º true æ—¶ï¼Œè¯¥å‚æ•°å¯ä¸ä¼ ã€‚

Name
auto_generate
Type
bool
Description
ï¼ˆé€‰å¡«ï¼‰è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ï¼Œé»˜è®¤ falseã€‚

Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Response
id (string) ä¼šè¯ ID
name (string) ä¼šè¯åç§°
inputs (object) ç”¨æˆ·è¾“å…¥å‚æ•°
status (string) ä¼šè¯çŠ¶æ€
introduction (string) å¼€åœºç™½
created_at (timestamp) åˆ›å»ºæ—¶é—´
updated_at (timestamp) æ›´æ–°æ—¶é—´
Request
POST
/conversations/:conversation_id/name
curl -X POST 'https://api.dify.ai/v1/conversations/:conversation_id/name' \
--header 'Authorization: Bearer {api_key}' \
--header 'Content-Type: application/json' \
--data-raw '{ 
 "name": "", 
 "auto_generate": true, 
 "user": "abc-123"
}'

Copy
Copied!
Response
{
  "id": "34d511d5-56de-4f16-a997-57b379508443",
  "name": "hello",
  "inputs": {},
  "status": "normal",
  "introduction": "",
  "created_at": 1732731141,
  "updated_at": 1732734510
}

Copy
Copied!
GET
/conversations/:conversation_id/variables
è·å–å¯¹è¯å˜é‡
ä»ç‰¹å®šå¯¹è¯ä¸­æ£€ç´¢å˜é‡ã€‚æ­¤ç«¯ç‚¹å¯¹äºæå–å¯¹è¯è¿‡ç¨‹ä¸­æ•è·çš„ç»“æ„åŒ–æ•°æ®éå¸¸æœ‰ç”¨ã€‚

è·¯å¾„å‚æ•°
Name
conversation_id
Type
string
Description
è¦ä»ä¸­æ£€ç´¢å˜é‡çš„å¯¹è¯IDã€‚

æŸ¥è¯¢å‚æ•°
Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ç¬¦ï¼Œç”±å¼€å‘äººå‘˜å®šä¹‰çš„è§„åˆ™ï¼Œåœ¨åº”ç”¨ç¨‹åºå†…å¿…é¡»å”¯ä¸€ã€‚

Name
last_id
Type
string
Description
ï¼ˆé€‰å¡«ï¼‰å½“å‰é¡µæœ€åé¢ä¸€æ¡è®°å½•çš„ IDï¼Œé»˜è®¤ null

Name
limit
Type
int
Description
ï¼ˆé€‰å¡«ï¼‰ä¸€æ¬¡è¯·æ±‚è¿”å›å¤šå°‘æ¡è®°å½•ï¼Œé»˜è®¤ 20 æ¡ï¼Œæœ€å¤§ 100 æ¡ï¼Œæœ€å° 1 æ¡ã€‚

å“åº”
limit (int) æ¯é¡µé¡¹ç›®æ•°
has_more (bool) æ˜¯å¦æœ‰æ›´å¤šé¡¹ç›®
data (array[object]) å˜é‡åˆ—è¡¨
id (string) å˜é‡ID
name (string) å˜é‡åç§°
value_type (string) å˜é‡ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”ç­‰ï¼‰
value (string) å˜é‡å€¼
description (string) å˜é‡æè¿°
created_at (int) åˆ›å»ºæ—¶é—´æˆ³
updated_at (int) æœ€åæ›´æ–°æ—¶é—´æˆ³
é”™è¯¯
404, conversation_not_exists, å¯¹è¯ä¸å­˜åœ¨
Request
GET
/conversations/:conversation_id/variables
curl -X GET 'https://api.dify.ai/v1/conversations/{conversation_id}/variables?user=abc-123' \
--header 'Authorization: Bearer {api_key}'

Copy
Copied!
Request with variable name filter
curl -X GET '${props.appDetail.api_base_url}/conversations/{conversation_id}/variables?user=abc-123&variable_name=customer_name' \
--header 'Authorization: Bearer {api_key}'

Copy
Copied!
Response
{
  "limit": 100,
  "has_more": false,
  "data": [
    {
      "id": "variable-uuid-1",
      "name": "customer_name",
      "value_type": "string",
      "value": "John Doe",
      "description": "å®¢æˆ·åç§°ï¼ˆä»å¯¹è¯ä¸­æå–ï¼‰",
      "created_at": 1650000000000,
      "updated_at": 1650000000000
    },
    {
      "id": "variable-uuid-2",
      "name": "order_details",
      "value_type": "json",
      "value": "{\"product\":\"Widget\",\"quantity\":5,\"price\":19.99}",
      "description": "å®¢æˆ·çš„è®¢å•è¯¦æƒ…",
      "created_at": 1650000000000,
      "updated_at": 1650000000000
    }
  ]
}

Copy
Copied!
POST
/audio-to-text
è¯­éŸ³è½¬æ–‡å­—
Request Body
è¯¥æ¥å£éœ€ä½¿ç”¨ multipart/form-data è¿›è¡Œè¯·æ±‚ã€‚

Name
file
Type
file
Description
è¯­éŸ³æ–‡ä»¶ã€‚ æ”¯æŒæ ¼å¼ï¼š['mp3', 'mp4', 'mpeg', 'mpga', 'm4a', 'wav', 'webm'] æ–‡ä»¶å¤§å°é™åˆ¶ï¼š15MB

Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Response
text (string) è¾“å‡ºæ–‡å­—
Request
POST
/audio-to-text
curl -X POST 'https://api.dify.ai/v1/audio-to-text' \
--header 'Authorization: Bearer {api_key}' \
--form 'file=@localfile;type=audio/[mp3|mp4|mpeg|mpga|m4a|wav|webm]

Copy
Copied!
Response
{
  "text": "hello"
}

Copy
Copied!
POST
/text-to-audio
æ–‡å­—è½¬è¯­éŸ³
æ–‡å­—è½¬è¯­éŸ³ã€‚

Request Body
Name
message_id
Type
str
Description
Dify ç”Ÿæˆçš„æ–‡æœ¬æ¶ˆæ¯ï¼Œé‚£ä¹ˆç›´æ¥ä¼ é€’ç”Ÿæˆçš„message-id å³å¯ï¼Œåå°ä¼šé€šè¿‡ message_id æŸ¥æ‰¾ç›¸åº”çš„å†…å®¹ç›´æ¥åˆæˆè¯­éŸ³ä¿¡æ¯ã€‚å¦‚æœåŒæ—¶ä¼  message_id å’Œ textï¼Œä¼˜å…ˆä½¿ç”¨ message_idã€‚

Name
text
Type
str
Description
è¯­éŸ³ç”Ÿæˆå†…å®¹ã€‚å¦‚æœæ²¡æœ‰ä¼  message-idçš„è¯ï¼Œåˆ™ä¼šä½¿ç”¨è¿™ä¸ªå­—æ®µçš„å†…å®¹

Name
user
Type
string
Description
ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚

Request
POST
/text-to-audio
curl --location --request POST 'https://api.dify.ai/v1/text-to-audio' \
--header 'Authorization: Bearer ENTER-YOUR-SECRET-KEY' \
--form 'text=ä½ å¥½Dify;user=abc-123;message_id=5ad4cb98-f0c7-4085-b384-88c403be6290

Copy
Copied!
headers
{
  "Content-Type": "audio/wav"
}

Copy
Copied!
GET
/info
è·å–åº”ç”¨åŸºæœ¬ä¿¡æ¯
ç”¨äºè·å–åº”ç”¨çš„åŸºæœ¬ä¿¡æ¯

Response
name (string) åº”ç”¨åç§°
description (string) åº”ç”¨æè¿°
tags (array[string]) åº”ç”¨æ ‡ç­¾
Request
GET
/info
curl -X GET 'https://api.dify.ai/v1/info' \
-H 'Authorization: Bearer {api_key}'

Copy
Copied!
Response
{
  "name": "My App",
  "description": "This is my app.",
  "tags": [
    "tag1",
    "tag2"
  ]
}

Copy
Copied!
GET
/parameters
è·å–åº”ç”¨å‚æ•°
ç”¨äºè¿›å…¥é¡µé¢ä¸€å¼€å§‹ï¼Œè·å–åŠŸèƒ½å¼€å…³ã€è¾“å…¥å‚æ•°åç§°ã€ç±»å‹åŠé»˜è®¤å€¼ç­‰ä½¿ç”¨ã€‚

Response
opening_statement (string) å¼€åœºç™½
suggested_questions (array[string]) å¼€åœºæ¨èé—®é¢˜åˆ—è¡¨
suggested_questions_after_answer (object) å¯ç”¨å›ç­”åç»™å‡ºæ¨èé—®é¢˜ã€‚
enabled (bool) æ˜¯å¦å¼€å¯
speech_to_text (object) è¯­éŸ³è½¬æ–‡æœ¬
enabled (bool) æ˜¯å¦å¼€å¯
retriever_resource (object) å¼•ç”¨å’Œå½’å±
enabled (bool) æ˜¯å¦å¼€å¯
annotation_reply (object) æ ‡è®°å›å¤
enabled (bool) æ˜¯å¦å¼€å¯
user_input_form (array[object]) ç”¨æˆ·è¾“å…¥è¡¨å•é…ç½®
text-input (object) æ–‡æœ¬è¾“å…¥æ§ä»¶
label (string) æ§ä»¶å±•ç¤ºæ ‡ç­¾å
variable (string) æ§ä»¶ ID
required (bool) æ˜¯å¦å¿…å¡«
default (string) é»˜è®¤å€¼
paragraph (object) æ®µè½æ–‡æœ¬è¾“å…¥æ§ä»¶
label (string) æ§ä»¶å±•ç¤ºæ ‡ç­¾å
variable (string) æ§ä»¶ ID
required (bool) æ˜¯å¦å¿…å¡«
default (string) é»˜è®¤å€¼
select (object) ä¸‹æ‹‰æ§ä»¶
label (string) æ§ä»¶å±•ç¤ºæ ‡ç­¾å
variable (string) æ§ä»¶ ID
required (bool) æ˜¯å¦å¿…å¡«
default (string) é»˜è®¤å€¼
options (array[string]) é€‰é¡¹å€¼
file_upload (object) æ–‡ä»¶ä¸Šä¼ é…ç½®
image (object) å›¾ç‰‡è®¾ç½® å½“å‰ä»…æ”¯æŒå›¾ç‰‡ç±»å‹ï¼špng, jpg, jpeg, webp, gif
enabled (bool) æ˜¯å¦å¼€å¯
number_limits (int) å›¾ç‰‡æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 3
transfer_methods (array[string]) ä¼ é€’æ–¹å¼åˆ—è¡¨ï¼Œremote_url , local_fileï¼Œå¿…é€‰ä¸€ä¸ª
system_parameters (object) ç³»ç»Ÿå‚æ•°
file_size_limit (int) æ–‡æ¡£ä¸Šä¼ å¤§å°é™åˆ¶ (MB)
image_file_size_limit (int) å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ï¼ˆMBï¼‰
audio_file_size_limit (int) éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ (MB)
video_file_size_limit (int) è§†é¢‘æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ (MB)
Request
GET
/parameters
 curl -X GET 'https://api.dify.ai/v1/parameters'\
--header 'Authorization: Bearer {api_key}'

Copy
Copied!
Response
{
  "introduction": "nice to meet you",
  "user_input_form": [
    {
      "text-input": {
        "label": "a",
        "variable": "a",
        "required": true,
        "max_length": 48,
        "default": ""
      }
    },
    {
      // ...
    }
  ],
  "file_upload": {
    "image": {
      "enabled": true,
      "number_limits": 3,
      "transfer_methods": [
        "remote_url",
        "local_file"
      ]
    }
  },
  "system_parameters": {
      "file_size_limit": 15,
      "image_file_size_limit": 10,
      "audio_file_size_limit": 50,
      "video_file_size_limit": 100
  }
}

Copy
Copied!
GET
/meta
è·å–åº”ç”¨Metaä¿¡æ¯
ç”¨äºè·å–å·¥å…·icon

Response
tool_icons(object[string]) å·¥å…·å›¾æ ‡
å·¥å…·åç§° (string)
icon (object|string)
(object) å›¾æ ‡
background (string) hexæ ¼å¼çš„èƒŒæ™¯è‰²
content(string) emoji
(string) å›¾æ ‡URL
Request
POST
/meta
curl -X GET 'https://api.dify.ai/v1/meta' \
-H 'Authorization: Bearer {api_key}'

Copy
Copied!
Response
{
  "tool_icons": {
      "dalle2": "https://cloud.dify.ai/console/api/workspaces/current/tool-provider/builtin/dalle/icon",
      "api_tool": {
          "background": "#252525",
          "content": "ğŸ˜"
      }
  }
}

Copy
Copied!